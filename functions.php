<?php

    // fonction permaettant d'Envoyer un tableau d'article 
    function getArticles() {
        return [
            // Article 1 
            [
                'name'                => 'Apple',
                'id'                  => '1',
                'price'               => 550.99,
                'description'         => 'Moderne et élégant',
                'detailleDescription' => 'Découvrez l\'Apple Watch : une montre intelligente alliant technologie avancée et design élégant. Restez connecté, suivez votre santé et bénéficiez de fonctionnalités pratiques, le tout à votre poignet. Une expérience unique alliant style et innovation.',
                'picture'             => 'sujet.png'
            ],
            // Article 2
            [
                'name'                => 'Omega',
                'id'                  => '2',
                'price'               => 1500.90,
                'description'         => 'Moderne et élégant',
                'detailleDescription' => 'Plongez dans l\'univers de l\'Omega Watch : une montre d\'exception alliant artisanat d\'élite et sophistication intemporelle. Découvrez un mariage parfait entre design raffiné et précision horlogère. Une montre qui incarne l\'excellence et l\'élégance à chaque instant.',
                'picture'             => 'sujet_2.png'
            ],
            // Article 3
            [
                'name'                => 'Rolex',
                'id'                  => '3',
                'price'               => 7500.99,
                'description'         => 'Moderne et élégant',
                'detailleDescription' => 'Explorez l\'univers de la Rolex : une icône intemporelle de l\'horlogerie alliant prestige, performance et artisanat d\'exception. Plongez dans l\'élégance inégalée d\'une montre synonyme de statut et de raffinement. L\'alliance parfaite entre sophistication et fiabilité, la Rolex incarne le luxe intemporel et l\'art de l\'horlogerie à son apogée.',
                'picture'             => 'sujet_3.png'
            ],
            // Article 4 
            [
                'name'                => 'Apple',
                'id'                  => '4',
                'price'               => 550.99,
                'description'         => 'Moderne et élégant',
                'detailleDescription' => 'Découvrez l\'Apple Watch : une montre intelligente alliant technologie avancée et design élégant. Restez connecté, suivez votre santé et bénéficiez de fonctionnalités pratiques, le tout à votre poignet. Une expérience unique alliant style et innovation.',
                'picture'             => 'sujet.png'
            ],
            // Article 5
            [
                'name'                => 'Omega',
                'id'                  => '5',
                'price'               => 1500.90,
                'description'         => 'Moderne et élégant',
                'detailleDescription' => 'Plongez dans l\'univers de l\'Omega Watch : une montre d\'exception alliant artisanat d\'élite et sophistication intemporelle. Découvrez un mariage parfait entre design raffiné et précision horlogère. Une montre qui incarne l\'excellence et l\'élégance à chaque instant.',
                'picture'             => 'sujet_2.png'
            ],
            // Article 6
            [
                'name'                => 'Rolex',
                'id'                  => '6',
                'price'               => 7500.99,
                'description'         => 'Moderne et élégant',
                'detailleDescription' => 'Explorez l\'univers de la Rolex : une icône intemporelle de l\'horlogerie alliant prestige, performance et artisanat d\'exception. Plongez dans l\'élégance inégalée d\'une montre synonyme de statut et de raffinement. L\'alliance parfaite entre sophistication et fiabilité, la Rolex incarne le luxe intemporel et l\'art de l\'horlogerie à son apogée.',
                'picture'             => 'sujet_3.png'
            ],
            // Article 7 
            [
                'name'                => 'Apple',
                'id'                  => '7',
                'price'               => 550.99,
                'description'         => 'Moderne et élégant',
                'detailleDescription' => 'Découvrez l\'Apple Watch : une montre intelligente alliant technologie avancée et design élégant. Restez connecté, suivez votre santé et bénéficiez de fonctionnalités pratiques, le tout à votre poignet. Une expérience unique alliant style et innovation.',
                'picture'             => 'sujet.png'
            ],
            // Article 8
            [
                'name'                => 'Omega',
                'id'                  => '8',
                'price'               => 1500.90,
                'description'         => 'Moderne et élégant',
                'detailleDescription' => 'Plongez dans l\'univers de l\'Omega Watch : une montre d\'exception alliant artisanat d\'élite et sophistication intemporelle. Découvrez un mariage parfait entre design raffiné et précision horlogère. Une montre qui incarne l\'excellence et l\'élégance à chaque instant.',
                'picture'             => 'sujet_2.png'
            ],
            // Article 9
            [
                'name'                => 'Rolex',
                'id'                  => '9',
                'price'               => 7500.99,
                'description'         => 'Moderne et élégant',
                'detailleDescription' => 'Explorez l\'univers de la Rolex : une icône intemporelle de l\'horlogerie alliant prestige, performance et artisanat d\'exception. Plongez dans l\'élégance inégalée d\'une montre synonyme de statut et de raffinement. L\'alliance parfaite entre sophistication et fiabilité, la Rolex incarne le luxe intemporel et l\'art de l\'horlogerie à son apogée.',
                'picture'             => 'sujet_3.png'
            ],
            // Article 10 
            [
                'name'                => 'Apple',
                'id'                  => '10',
                'price'               => 550.99,
                'description'         => 'Moderne et élégant',
                'detailleDescription' => 'Découvrez l\'Apple Watch : une montre intelligente alliant technologie avancée et design élégant. Restez connecté, suivez votre santé et bénéficiez de fonctionnalités pratiques, le tout à votre poignet. Une expérience unique alliant style et innovation.',
                'picture'             => 'sujet.png'
            ],
            // Article 11
            [
                'name'                => 'Omega',
                'id'                  => '11',
                'price'               => 1500.90,
                'description'         => 'Moderne et élégant',
                'detailleDescription' => 'Plongez dans l\'univers de l\'Omega Watch : une montre d\'exception alliant artisanat d\'élite et sophistication intemporelle. Découvrez un mariage parfait entre design raffiné et précision horlogère. Une montre qui incarne l\'excellence et l\'élégance à chaque instant.',
                'picture'             => 'sujet_2.png'
            ],
            // Article 12
            [
                'name'                => 'Rolex',
                'id'                  => '12',
                'price'               => 7500.99,
                'description'         => 'Moderne et élégant',
                'detailleDescription' => 'Explorez l\'univers de la Rolex : une icône intemporelle de l\'horlogerie alliant prestige, performance et artisanat d\'exception. Plongez dans l\'élégance inégalée d\'une montre synonyme de statut et de raffinement. L\'alliance parfaite entre sophistication et fiabilité, la Rolex incarne le luxe intemporel et l\'art de l\'horlogerie à son apogée.',
                'picture'             => 'sujet_3.png'
            ],
            // Article 13 
            [
                'name'                => 'Apple',
                'id'                  => '13',
                'price'               => 550.99,
                'description'         => 'Moderne et élégant',
                'detailleDescription' => 'Découvrez l\'Apple Watch : une montre intelligente alliant technologie avancée et design élégant. Restez connecté, suivez votre santé et bénéficiez de fonctionnalités pratiques, le tout à votre poignet. Une expérience unique alliant style et innovation.',
                'picture'             => 'sujet.png'
            ],
            // Article 14
            [
                'name'                => 'Omega',
                'id'                  => '14',
                'price'               => 1500.90,
                'description'         => 'Moderne et élégant',
                'detailleDescription' => 'Plongez dans l\'univers de l\'Omega Watch : une montre d\'exception alliant artisanat d\'élite et sophistication intemporelle. Découvrez un mariage parfait entre design raffiné et précision horlogère. Une montre qui incarne l\'excellence et l\'élégance à chaque instant.',
                'picture'             => 'sujet_2.png'
            ],
        ];
    }





    // Récupérer le produit qui correspond à l'Id fourni en paramètre
    function getArticleFromId($id) {
        //récupérer la liste des articles
        $articles = getArticles();
        // aller chercher dedans l'article qui comporte l'id en paramètre
        foreach ($articles as $article) {
            if ($article['id'] == $id) {
                // le renvoyer avce un return
                return $article;
            }
        }
        // le renvoyer avec un return
    }





    // initaliser le panier 
    function createCart() {
       if (isset($_SESSION['panier']) == false) {  // si mon panier n'existe pas encore 
        $_SESSION['panier'] = [];               // je l'initialise
        }
    }





    function addToCart($article) {
        // on attribut une quandtité de 1 ( par defaut ) à l'articel 
        $article['quantite'] = 1;
        // je verifie si l'article n'est pas déja présent
        // $i = index de la boucle
        // $i < count($_SESSION['panier]) = condition de maintien de la boucle ( évaluée AVANT chaque tour )
        // (si condition vraie => on lance la boucle)
        // $i++ = évolution d el'index $i à la FIN de chaque boucle
        for ($i = 0; $i < count($_SESSION['panier']); $i++) {
            // si present = quantite +1
            if ($_SESSION['panier'][$i]['id'] == $article['id']) {
                $_SESSION['panier'][$i]['quantite']++;
                return; // permet de sortir de la fonction
            }
        }
        // si pas present => ajout classqiue via array_push
        array_push($_SESSION['panier'], $article);
    }





    function totalPanier() {
        $totalPanier = 0; 
        foreach ($_SESSION['panier'] as $article) {
            // Quantiter x prix 
            $totalPanier += $article['quantite'] * $article['price'];
        }
        return $totalPanier;
    }





    // modifier la quantite de l'article dans le panier
    function updateQuantity() {
        // je boucle sur le panier => je cherche l'article à modifier 
        for ($i = 0; $i < count($_SESSION['panier']); $i++) {
            // des que je trouyve mon article 
            if ($_SESSION['panier'][$i]['id'] == $_POST['modifiedArticleId']) {
                // je remplace son ancienne quantite par la nouvelle 
                $_SESSION['panier'][$i]['quantite'] = $_POST['newQuantity'];
                // j'affiche un message de succès dans une petite fenêtre via JavaScript 
                echo "<script> alert(\"Quantité modifiée !\");</script>";
                // Je sort de la fonction pour eviter de boucler sur les articles suivants
                return;
            }
        }
    }





    function deleteArticle($productId) {
        if (isset($_SESSION['panier'])) {
            foreach ($_SESSION['panier'] as $key => $article) {
                if ($article['id'] === $productId) {
                    array_splice($_SESSION['panier'], $key, 1);
                    break;
                }
            }
        }
    }






    function viderPanier() {
        $_SESSION['panier'] = array();
    }






    //function calculerFraisPort()
    function frais() {
        $totalFrais = 0; 
        $fraisParArticle = 3;
        foreach ($_SESSION['panier'] as $article) {
            // Quantiter x prix 
            $totalFrais += $article['quantite'] * $fraisParArticle;
        }
        return $totalFrais;
    }
?>